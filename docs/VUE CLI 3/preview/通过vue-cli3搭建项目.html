<html>
  <head>
	  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>i5ting_ztree_toc:通过vue-cli3搭建项目</title>
		<link href="toc/style/github-bf51422f4bb36427d391e4b75a1daa083c2d840e.css" media="all" rel="stylesheet" type="text/css"/>
		<link href="toc/style/github2-d731afd4f624c99a4b19ad69f3083cd6d02b81d5.css" media="all" rel="stylesheet" type="text/css"/>
		<link href="toc/css/zTreeStyle/zTreeStyle.css" media="all" rel="stylesheet" type="text/css"/>
	  <style>
		pre {
		    counter-reset: line-numbering;
		    border: solid 1px #d9d9d9;
		    border-radius: 0;
		    background: #fff;
		    padding: 0;
		    line-height: 23px;
		    margin-bottom: 30px;
		    white-space: pre;
		    overflow-x: auto;
		    word-break: inherit;
		    word-wrap: inherit;
		}

		pre a::before {
		  content: counter(line-numbering);
		  counter-increment: line-numbering;
		  padding-right: 1em; /* space after numbers */
		  width: 25px;
		  text-align: right;
		  opacity: 0.7;
		  display: inline-block;
		  color: #aaa;
		  background: #eee;
		  margin-right: 16px;
		  padding: 2px 10px;
		  font-size: 13px;
		  -webkit-touch-callout: none;
		  -webkit-user-select: none;
		  -khtml-user-select: none;
		  -moz-user-select: none;
		  -ms-user-select: none;
		  user-select: none;
		}

		pre a:first-of-type::before {
		  padding-top: 10px;
		}

		pre a:last-of-type::before {
		  padding-bottom: 10px;
		}

		pre a:only-of-type::before {
		  padding: 10px;
		}

		.highlight { background-color: #ffffcc } /* RIGHT */
		</style>
  </head>
  <body>
	  <div>
				<div style='width:25%;'>
						<ul id="tree" class="ztree" style='width:100%'>

						</ul>
				</div>
        <div id='readme' style='width:70%;margin-left:20%;'>
          	<article class='markdown-body'>
            	<h1 align="center">vue-cli3 搭建项目</h1>

<h2 id="vue3-0-">vue3.0 搭建脚手架</h2>
<pre><code>\\ 查看 vue 版本
vue -V

\\ 如果版本低于 3.0 先卸载 vue
npm uninstall vue-cli -g 或 yarn global remove vue-cli

\\ 再安装最新 vue
npm install -g @vue/cli 或 yarn global add @vue/cli

\\ 创建项目
vue create &lt;project-name&gt;
</code></pre><h2 id="vue3-0-"><a href="https://www.jianshu.com/p/191d1e21f7ed">vue3.0 移动端适配</a></h2>
<ol>
<li>引入 lib-flexible</li>
</ol>
<p>作用：让网页根据设备 dpr 和宽度，利用 viewport 和 html 根元素的 font-size 配合 rem 来适配不同尺寸的移动端设备</p>
<p>安装：yarn add lib-flexible</p>
<p>引入：入口文件 main.js 中：import &#39;lib-flexible/flexible.js&#39;</p>
<ol start="2">
<li>引入 pxtorem</li>
</ol>
<p>作用：将项目中 css 的 px 转成 rem 单位，免去计算烦恼</p>
<p>安装：yarn add postcss-pxtorem</p>
<p>配置：package.json 内，在 postcss 内添加：</p>
<pre><code>&quot;postcss&quot;: {
  &quot;plugins&quot;: {
    &quot;autoprefixer&quot;: {},
    &quot;postcss-pxtorem&quot;: {
      &quot;rootValue&quot;: 75, // 设计稿宽度的1/10,（JSON文件中不加注释，此行注释及下行注释均删除）
      &quot;propList&quot;:[&quot;*&quot;] // 需要做转化处理的属性，如`hight`、`width`、`margin`等，`*`表示全部
    }
  }
}
</code></pre><h2 id="vue3-0-build-">vue3.0 build 包太大导致首屏过长的解决方案</h2>
<ol>
<li>路由懒加载</li>
</ol>
<p>结合 Vue 的异步组件再结合 webpack 的代码分割，我们可以轻松的实现路由懒加载。</p>
<p>vue-cli 3.0 模式就使用了 Babel，我们需要添加 syntax-dynamic-import 插件，才能使 Babel 可以正确地解析语法。</p>
<pre><code>// 安装插件 syntax-dynamic-import
cnpm install --save-dev @babel/plugin-syntax-dynamic-import

// 修改babel.config.js
module.exports = {
  &quot;presets&quot;: [
    &quot;@vue/app&quot;
  ],
  &quot;plugins&quot;: [
    [
      &quot;component&quot;,
      {
        &quot;libraryName&quot;: &quot;element-ui&quot;,
        &quot;styleLibraryName&quot;: &quot;theme-chalk&quot;
      },
      &quot;syntax-dynamic-import&quot;
    ]
  ]
}

// 修改路由组件的加载（router/index.js）
{
  path: &#39;/&#39;,
  name: &#39;home&#39;,
  component: resolve =&gt; require([&#39;pages/Home&#39;], resolve)
}
</code></pre><ol start="2">
<li>服务器开启 Gzip</li>
</ol>
<p>Gzip 是 GNU zip 的缩写，顾名思义是一种压缩技术。它将浏览器请求的文件先在服务器端进行压缩，然后传递给浏览器，浏览器解压之后再进行页面的解析工作。在服务端开启 Gzip 支持后，我们前端需要提供资源压缩包。</p>
<p>通过 CompressionWebpackPlugin 插件 build 提供压缩</p>
<pre><code>// 安装插件
cnpm i --save-dev compression-webpack-plugin

// 在vue-config.js 中加入
const CompressionWebpackPlugin = require(&#39;compression-webpack-plugin&#39;);
const productionGzipExtensions = [&#39;js&#39;, &#39;css&#39;];
const isProduction = process.env.NODE_ENV === &#39;production&#39;;

.....
module.exports = {
....
  configureWebpack: config =&gt; {
    if (isProduction) {
      config.plugins.push(new CompressionWebpackPlugin({
        algorithm: &#39;gzip&#39;,
        test: new RegExp(&#39;\\.(&#39; + productionGzipExtensions.join(&#39;|&#39;) + &#39;)$&#39;),
        threshold: 10240,
        minRatio: 0.8
      }))
    }
  }
}
</code></pre><ol start="3">
<li>启用 CDN 加速</li>
</ol>
<p>Gzip 已把文件的大小减少了三分之二了，加载速度从之前 2.7 秒多到现在的 1.8 秒多，但这个还是得不到满足。那我们就把那些不太可能改动的代码或者库分离出来，继续减小单个 chunk-vendors，然后通过 CDN 加载进行加速加载资源。</p>
<pre><code>// 修改vue.config.js 分离不常用代码库
module.exports = {
  configureWebpack: config =&gt; {
    if (isProduction) {
      config.externals = {
        &#39;vue&#39;: &#39;Vue&#39;,
        &#39;vue-router&#39;: &#39;VueRouter&#39;,
        &#39;moment&#39;: &#39;moment&#39;
      }
    }
  }
}
// 在public文件夹的index.html 加载

&lt;!-- CND --&gt;
&lt;!--
&lt;script src=&quot;https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.runtime.min.js&quot;&gt;&lt;/script&gt;
--&gt;
&lt;script src=&quot;https://cdn.bootcss.com/vue/2.5.17/vue.runtime.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.bootcss.com/vue-router/3.0.1/vue-router.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js&quot;&gt;&lt;/script&gt;

</code></pre><ol start="4">
<li>修改 uglifyOptions 去除 console 来减少文件大小</li>
</ol>
<pre><code>// 安装uglifyjs-webpack-plugin
cnpm install uglifyjs-webpack-plugin --save-dev

// 修改vue.config.js
  configureWebpack: config =&gt; {
    if (isProduction) {
      .....
      config.plugins.push(
        new UglifyJsPlugin({
          uglifyOptions: {
            compress: {
              warnings: false,
              drop_debugger: true,
              drop_console: true,
            },
          },
          sourceMap: false,
          parallel: true,
        })
      )
    }
  }
</code></pre>
          	</article>
        </div>
		</div>
  </body>
</html>
<script type="text/javascript" src="toc/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="toc/js/jquery.ztree.all-3.5.min.js"></script>
<script type="text/javascript" src="toc/js/ztree_toc.js"></script>
<script type="text/javascript" src="toc_conf.js"></script>

<SCRIPT type="text/javascript" >
<!--
$(document).ready(function(){
    var css_conf = eval(markdown_panel_style);
    $('#readme').css(css_conf)
    
    var conf = eval(jquery_ztree_toc_opts);
		$('#tree').ztree_toc(conf);
});
//-->
</SCRIPT>