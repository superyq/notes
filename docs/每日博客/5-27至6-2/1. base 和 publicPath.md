# vue 开发中的 base 和 publicPath

前言：本地开发好好的，一打包上线，就是各种问题。

vue-cli，一般是 vue2+webpack 的配置，

```js
module.exports = {
  publicPath: "/",
};
```

base 是 vue-router 里面的配置

```js
const router = new VueRouter({
  base: "/",
});
```

这两个配置一般影响的是生成环境，对本地开发没啥影响。
publicPath 影响的是打包结果，打包结果只有一个页面，html 只有一个。运维会做一个映射关系，

如果域名是www.a.com/，访问根路径会指向index.html
如果是www.a.com/a/b，也可以指向index.html
页面拿到了，但是外部资源拿不到，比如相对路径 css/xxx.css 等于 ./css/xxx.cc

www.a.com/ => www.a.com/css/xxx.cc
www.a.com/a/b/c => www.a.com/a/b/css/xxx.cc

首页没问题，其他页面就拿不到资源，啥都没有。

所以要写成绝对路径，/css/xxx.css 都是加载 www.a.com/css/xxx.cc

所以打包出来的页面，我们需要控制前缀，用 vue.config.js 里得 publicPath 控制，所以我们用 publicPath: '/'，统一改成绝对路径

加入运维将我们得站点部署到一个子目录下的。比如 admin 文件夹下，我们通过www.a.com/admin 来访问，子目录www.a.com/admin/a/b/c
那么我们的资源也需要加上这些前缀，将 publicPath: '/admin'

路由匹配组件，线上可能会有问题，比如有前缀/admin，比如我们路由写的/user 去匹配 User.vue 组件，但是生产上访问就是www.a.com/admin/user 去匹配，肯定就匹配不上，所以我们需要在 base 配置里面，统一配置下 base: '/admin'

所以base影响的是组件匹配
publicPath影响的是外部资源的获取

所以一般这两个东西是写在环境变量里的
