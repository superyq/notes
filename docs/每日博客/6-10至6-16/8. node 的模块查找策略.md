# node 的模块查找策略

前言：我们引入模块后，node 大概的查找步骤分为 文件查找、文件夹查找、内置模块查找、第三方模块查找，在 node 中使用 ESM 模块语法，需要创建 package.json 文件，并将 type 设置为 module。简单起见，我们用 CommonJs 模块语法，查找策略时一样的。

1. 文件/文件夹 查找

什么时候触发文件查找勒，node 会分析你的引用路径，发现我们引入模块使用绝对路径或者相对路径时。它会进入文件查找逻辑，根据路径去查找文件，如果没有 a 文件，会自动查找后缀名是 js 或 json 的同名文件。如果文件查找没找到，就会进入文件夹的模式，找到同名文件夹，如果文件夹里有 package.json 文件，根据文件中的 main 指向找到对应文件，如果没有 main 或者 main 字段没找到相应文件，就会找文件夹下的 index.js 文件。

```js
import a from "/a";
// or
import a from "./a";
// or
import a from "../a";
```

2. 内置模块/第三方模块 查找

什么时候触发内置模块的查找呢，就是引入的路径直接以字符开头，node 就会进入内置模块和第三方模块查找，如果是内置模块，会直接拿到结果。如果不是内置模块，会进入第三方模块查找。找到当前目录下的 node_modules 目录，在这个目录下找模块，如果在这个目录下没找到，又会进入文件/文件夹查找逻辑。如果当前目录没有 node_modules 它会往上级目录去找，直到找到这个系统的根目录。还找不到的话，就真找不到了。

```js
// 内置模块
import fs from "fs";

// 第三方模块
import vue from "vue";
```
